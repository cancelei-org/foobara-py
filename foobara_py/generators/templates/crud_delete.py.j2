"""Delete {{ entity_name }} command."""

from pydantic import BaseModel
from foobara_py import Command{% if domain_name %}, Domain{% endif %}
from foobara_py.core.errors import NotFoundError

from {{ entity_module }} import {{ entity_name }}

{% if domain_name %}

{{ domain_name | snake_case }}_domain = Domain("{{ domain_name | pascal_case }}"{% if organization_name %}, organization="{{ organization_name | pascal_case }}"{% endif %})

{% endif %}

class {{ command_name }}Inputs(BaseModel):
    """Inputs for deleting a {{ entity_name }}."""

    {{ primary_key }}: {{ pk_field.type }}{% if pk_field.description %}  # {{ pk_field.description }}{% endif %}


{% if domain_name %}
@{{ domain_name | snake_case }}_domain.command
{% endif %}
class {{ command_name }}(Command[{{ command_name }}Inputs, bool]):
    """
    Delete a {{ entity_name }} by {{ primary_key }}.

    Permanently removes a {{ entity_name }} record from the database.

    Returns:
        True if successfully deleted.

    Raises:
        NotFoundError: If {{ entity_name }} with given {{ primary_key }} not found.
    """

    def execute(self) -> bool:
        """Execute the command."""
        # Find existing entity
        entity = {{ entity_name }}.find(self.inputs.{{ primary_key }})

        if not entity:
            raise NotFoundError(
                f"{{ entity_name }} with {{ primary_key }}={self.inputs.{{ primary_key }}} not found"
            )

        # Delete and return success
        entity.delete()
        return True
